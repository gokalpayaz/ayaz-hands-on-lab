fileVersion: 1
id: 7ca5e3d4-221e-489f-be4d-a163823baa81
name: STG_LINEITEM_ORDERS
operation:
  config:
    insertStrategy: INSERT
    postSQL: ""
    preSQL: ""
    testsEnabled: true
    truncateBefore: true
  database: ""
  deployEnabled: true
  description: ""
  isMultisource: false
  locationName: WORK
  materializationType: table
  metadata:
    appliedNodeTests: []
    columns:
      - appliedColumnTests: {}
        columnReference:
          columnCounter: befdc5fc-c045-4d6c-89a9-d2cd80faa8ec
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_CUSTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 657b81b5-b82f-4f76-a426-2dce8915cb60
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d1c846a-3a00-46a0-bac1-183b82d5b33f
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_SUPPKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 146f6c9d-fc22-43ee-a010-816872d440c8
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7b3ecbd8-2ffd-413b-802c-3df3f50cc259
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_PARTKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 331d94bd-f266-4e23-ab18-f1019c9da98d
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f37ef681-aa9f-4b9b-b6b4-198acc55df96
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 8d866893-823c-4507-9a0e-dd721d42f5d5
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4691b8f4-c757-4662-8c5b-6b4bd4d37756
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: L_LINENUMBER
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: d7fde5fa-f601-44a0-98ae-37d096965d1d
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d2ee1733-d502-4e57-9760-2046cac1994d
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_QUANTITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 830204eb-e930-46e9-a74d-8fb0fecf8497
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 71a5b145-d9dd-4469-a95d-ec1f63b6cfb3
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_EXTENDEDPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f610b787-dfd8-4c74-ab73-6451a220a730
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: fafa4a1b-d089-4c25-9499-f185229cdc6c
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_DISCOUNT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 2f51365e-59be-43b0-9175-1a7bf4addbdd
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1b6d1a17-50d1-4b0e-9e34-0075bed5ac84
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: L_TAX
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 39513a99-9eea-4417-b480-a01009e33019
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d6a416cb-e373-48e0-ade0-8269715d746a
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_RETURNFLAG
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: f4935df8-3888-4dc9-971a-b8a40b359147
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: c8a44578-53ed-4952-82d3-7d042a2f79c0
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: L_LINESTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c5885c12-8b5e-4b54-b0fe-36f85f110ce0
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 82e493b1-18f4-48bc-a836-1c74fe2f4767
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: DATE
        description: ""
        name: L_SHIPDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 1f5fd03f-3bf2-433e-8794-c6d4983a66ac
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 139f9c84-6b99-4ff0-9d07-8b5cf015c024
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: DATE
        description: ""
        name: L_COMMITDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 55667be0-6e7d-4748-8ea9-654d72032c35
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 5aebed8b-b33b-48e5-9ba3-68c23afe2c7d
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: DATE
        description: ""
        name: L_RECEIPTDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: dc9048a4-ca31-42b9-bb69-fb135581d7d8
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 20dbd950-6050-4b42-bd7e-5406842ec746
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(25)
        description: ""
        name: L_SHIPINSTRUCT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 71c19d93-f431-4062-805d-9818f370ed8c
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: d665967a-79c3-49bd-a12b-ee5b5336c0d0
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(10)
        description: ""
        name: L_SHIPMODE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 339c84fa-d01e-48b8-819b-690cdaacbdf5
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4e0a2ec6-6b92-4c8a-b899-bcc98e9461cd
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(44)
        description: ""
        name: L_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 75784281-dbbe-4010-8602-56f820c90fb8
                stepCounter: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 4fbb958c-1df6-456d-af78-c0ab0d93d5bd
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_ORDERKEY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: af4d05ff-813c-4f89-8771-c068d062702c
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 52c6e087-8dee-4245-b8c6-7a818c51cead
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(1)
        description: ""
        name: O_ORDERSTATUS
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: adbc25bf-4fac-4d0e-91eb-bab9cfbdeca5
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7c0c621a-7f82-4c72-a2f8-9d6f57a98947
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: O_TOTALPRICE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ebf6de75-ddf2-418e-b61e-c7a6c84639b1
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 6d3d992f-bf7f-43fb-bcba-13f54490ea50
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: DATE
        description: ""
        name: O_ORDERDATE
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 6070ec82-d8e7-4e0e-b9bf-4146b07f903f
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: f3412ab8-341d-499c-91ea-99cbb6424ff5
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_NUM
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b519b200-50da-4fdc-b7b2-3521b8e152b2
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY", '-', 1 )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 26361849-9d6e-46b8-943d-3ea0f298afd1
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_ORDERPRIORITY_DESC
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: b519b200-50da-4fdc-b7b2-3521b8e152b2
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: SPLIT_PART("STG_ORDERS"."O_ORDERPRIORITY", '-', 2 )
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 1e661ed3-a0da-4796-a1f9-fb40a95dcefc
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(15)
        description: ""
        name: O_CLERK
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: c1f0b3df-5665-460a-9fd3-e3b1a0b5622d
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: adaecaba-081e-4219-aa02-ff4be1b1cc74
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: O_SHIPPRIORITY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: a653e5fe-1824-4e71-a878-711816adcaa6
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 7d90c4fa-8ca3-4913-8619-b4d13c7fd292
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: VARCHAR(79)
        description: ""
        name: O_COMMENT
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: 7b9c5df1-4f6e-4975-b396-4ec9e4efbebd
                stepCounter: 2e3483dd-d326-4b68-8306-c66d7c02f698
            transform: ""
      - acceptedValues:
          strictMatch: true
          values: []
        appliedColumnTests: {}
        columnReference:
          columnCounter: 6c5ba39c-53ee-41c0-90fe-661ca5597458
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER
        defaultValue: ""
        description: ""
        keyColumnType: None
        name: DAYS TO SHIP
        nullable: true
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: "0"
                stepCounter: "0"
            transform: DATEDIFF('DAY',"STG_ORDERS"."O_ORDERDATE","STG_LINEITEM"."L_SHIPDATE")
        systemColumnType: None
      - appliedColumnTests: {}
        columnReference:
          columnCounter: b4dee061-46f3-4eca-990a-2a1cfae4e7af
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(38,0)
        description: ""
        name: PS_AVAILQTY
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: e236cb42-c825-4e15-9fef-c262a9c509d9
                stepCounter: 848d88f1-f0e4-4b10-a06a-2a6c61c3c15a
            transform: ""
      - appliedColumnTests: {}
        columnReference:
          columnCounter: 81499615-0b23-429c-9d90-1ab33db9d47f
          stepCounter: 7ca5e3d4-221e-489f-be4d-a163823baa81
        config: {}
        dataType: NUMBER(12,2)
        description: ""
        name: PS_SUPPLYCOST
        nullable: false
        sourceColumnReferences:
          - columnReferences:
              - columnCounter: ddc2b6f7-0cfc-4c47-86b2-fccf06bc1d49
                stepCounter: 848d88f1-f0e4-4b10-a06a-2a6c61c3c15a
            transform: ""
    cteString: ""
    enabledColumnTestIDs: []
    sourceMapping:
      - aliases:
          STG_LINEITEM: 81ce6a6e-b4a7-4d51-83f7-e6405a1f7b36
          STG_ORDERS: 2e3483dd-d326-4b68-8306-c66d7c02f698
          STG_PARTSUPP: 848d88f1-f0e4-4b10-a06a-2a6c61c3c15a
        customSQL:
          customSQL: ""
        dependencies:
          - locationName: WORK
            nodeName: STG_LINEITEM
          - locationName: WORK
            nodeName: STG_ORDERS
          - locationName: WORK
            nodeName: STG_PARTSUPP
        join:
          joinCondition: |-
            FROM {{ ref('WORK', 'STG_ORDERS') }} "STG_ORDERS"

            INNER JOIN {{ ref('WORK', 'STG_LINEITEM') }} "STG_LINEITEM"

            ON "STG_ORDERS"."O_ORDERKEY" = "STG_LINEITEM"."L_ORDERKEY"

            INNER JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"

            ON "STG_LINEITEM"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND "STG_LINEITEM"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
        name: STG_LINEITEM_ORDERS
        noLinkRefs: []
  name: STG_LINEITEM_ORDERS
  overrideSQL: false
  schema: ""
  sqlType: Stage
  type: sql
  version: 1
type: Node
